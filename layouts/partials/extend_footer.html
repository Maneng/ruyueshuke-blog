{{- /* ç½‘ç«™å¤‡æ¡ˆä¿¡æ¯ */ -}}
<div style="text-align: center; margin-top: 20px; padding: 10px; font-size: 0.85em; color: #666;">
    <p style="margin: 5px 0;">
        å¦‚çº¦æ•°ç§‘ç§‘æŠ€å·¥ä½œå®¤
    </p>
    <p style="margin: 5px 0;">
        <a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener noreferrer" style="color: #666; text-decoration: none;">
            æµ™ICPå¤‡2025203501å·
        </a>
    </p>
</div>

{{- /* è‡ªå»ºè®¿å®¢ç»Ÿè®¡ */ -}}
<div style="text-align: center; margin-top: 15px; padding: 8px; font-size: 0.85em; color: #999;">
    <span style="margin: 0 10px;">
        ğŸ‘€ æœ¬ç«™æ€»è®¿é—®é‡ <span id="total-pv" style="color: #4a9eff; font-weight: 600;">...</span> æ¬¡
    </span>
    <span style="margin: 0 5px;">|</span>
    <span style="margin: 0 10px;">
        ğŸ‘¤ è®¿å®¢æ•° <span id="total-uv" style="color: #ff6b6b; font-weight: 600;">...</span> äºº
    </span>
    <span style="margin: 0 5px;">|</span>
    <span style="margin: 0 10px;">
        ğŸ“… ä»Šæ—¥è®¿é—® <span id="today-pv" style="color: #51cf66; font-weight: 600;">...</span> æ¬¡
    </span>
</div>

{{- /* è®¿å®¢ç»Ÿè®¡è„šæœ¬ */ -}}
<script>
(function() {
    // APIåœ°å€ï¼ˆæ ¹æ®å®é™…éƒ¨ç½²æƒ…å†µè°ƒæ•´ï¼‰
    const API_BASE = 'https://ruyueshuke.com/api/stats';

    // è®°å½•æœ¬æ¬¡è®¿é—®
    function recordVisit() {
        fetch(API_BASE + '/visit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                url: window.location.href
            })
        }).catch(err => {
            console.warn('è®¿é—®ç»Ÿè®¡è®°å½•å¤±è´¥:', err);
        });
    }

    // è·å–ç»Ÿè®¡æ•°æ®
    function loadStats() {
        fetch(API_BASE)
            .then(response => response.json())
            .then(data => {
                if (data.success && data.data) {
                    document.getElementById('total-pv').textContent = formatNumber(data.data.total_pv);
                    document.getElementById('total-uv').textContent = formatNumber(data.data.total_uv);
                    document.getElementById('today-pv').textContent = formatNumber(data.data.today_pv);
                }
            })
            .catch(err => {
                console.warn('è®¿é—®ç»Ÿè®¡åŠ è½½å¤±è´¥:', err);
                // åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºé»˜è®¤å€¼
                document.getElementById('total-pv').textContent = '-';
                document.getElementById('total-uv').textContent = '-';
                document.getElementById('today-pv').textContent = '-';
            });
    }

    // æ ¼å¼åŒ–æ•°å­—ï¼ˆæ·»åŠ åƒåˆ†ä½ï¼‰
    function formatNumber(num) {
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }

    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            recordVisit();
            loadStats();
        });
    } else {
        recordVisit();
        loadStats();
    }
})();
</script>
